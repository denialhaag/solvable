(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15010,        357]
NotebookOptionsPosition[     13347,        321]
NotebookOutlinePosition[     13799,        339]
CellTagsIndexPosition[     13756,        336]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.855733141749468*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"694fd6f5-b194-4272-8845-48634371335b"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<mps.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{
  3.8557331493212433`*^9, {3.8812190243981743`*^9, 3.881219027148205*^9}, 
   3.8812192542212667`*^9, {3.881909479986278*^9, 3.881909482915728*^9}, {
   3.8819493239621572`*^9, 3.881949325212426*^9}, {3.88199100483967*^9, 
   3.881991006535636*^9}, {3.901799366862315*^9, 3.901799367132842*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d9329c70-b302-47a9-aaa1-8b0a48969354"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.901540432770752*^9, 3.901540433495084*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6ba1c8c3-3fc4-4804-9eff-855d4bf927e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.901540416098475*^9, 3.901540417222094*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"05f0ed0b-6a4d-4b70-91e6-304625873ee5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Sigma]", "x"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.901539414830117*^9, 3.9015394310395*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"15f8e82d-ceb0-4c5c-8059-cfe00bf8c7d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", 
   RowBox[{"\"\<l\>\"", ",", "k", ",", "d", ",", "\[Chi]", ",", 
    SubscriptBox["\[Sigma]", "x"]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8819095178138533`*^9, 3.881909519372464*^9}, {
  3.881909575778492*^9, 3.8819095772962303`*^9}, {3.881918600590437*^9, 
  3.8819186007333307`*^9}, {3.881918708343691*^9, 3.881918745546554*^9}, {
  3.8819195609178047`*^9, 3.88191956100447*^9}, {3.881919689085404*^9, 
  3.881919689367104*^9}, {3.881920274846909*^9, 3.881920274959436*^9}, {
  3.9015378219743767`*^9, 3.901537856728026*^9}, {3.901538116764703*^9, 
  3.901538119407419*^9}, {3.901538561098135*^9, 3.9015385612174063`*^9}, {
  3.901539434112687*^9, 3.901539440866729*^9}, {3.901540310991931*^9, 
  3.901540332758731*^9}, {3.901540419556965*^9, 3.901540435558137*^9}, {
  3.901540508961792*^9, 3.901540510923946*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"a94be308-bd99-4e98-af1b-c061130b0a93"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{"4", " ", "\[Chi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Chi]", "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.881909563870645*^9, 3.881909600398367*^9, 3.881918614106638*^9, 
   3.881918725089582*^9, 3.881918775751561*^9, 3.881919571523325*^9, 
   3.881919720969976*^9, 3.881919779566996*^9, {3.881919832417964*^9, 
   3.881919848408803*^9}, 3.881919956393653*^9, {3.881920305101747*^9, 
   3.881920356990163*^9}, 3.881921685563043*^9, 3.881923366585582*^9, 
   3.881923428563641*^9, 3.881923849024844*^9, 3.881924007723982*^9, 
   3.881925766274469*^9, 3.8819259803952913`*^9, 3.881926060629154*^9, 
   3.881926175910192*^9, 3.881926275203117*^9, 3.881926497566475*^9, 
   3.881926932004887*^9, 3.881949368466794*^9, {3.881949888796362*^9, 
   3.8819499061326427`*^9}, 3.8819905793275347`*^9, 3.881990716835309*^9, 
   3.882419760160837*^9, 3.882421585935918*^9, 3.882421711502784*^9, {
   3.882421782859236*^9, 3.882421817661347*^9}, 3.901537859744361*^9, 
   3.90153792151304*^9, 3.901538015233253*^9, 3.901538119927281*^9, {
   3.901538552616558*^9, 3.901538561576539*^9}, 3.901539441293741*^9, {
   3.901540315153503*^9, 3.9015403329645*^9}, 3.9015405316784973`*^9, 
   3.901798370681795*^9, 3.901799371476472*^9},
 CellLabel->
  "Out[6]//MatrixForm=",ExpressionUUID->"6ba95f69-b0cb-4f71-9068-\
34aa9cfffd01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", 
   RowBox[{"k", ",", "d", ",", "\[Chi]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.871554832116238*^9, 3.871554857853631*^9}, {
  3.8715550158163023`*^9, 3.871555017186561*^9}, {3.881220716415372*^9, 
  3.881220724460738*^9}, {3.8812207714474783`*^9, 3.8812207747844543`*^9}, {
  3.881220812186133*^9, 3.881220819329793*^9}, {3.881909505356848*^9, 
  3.88190951180884*^9}, {3.881909579666409*^9, 3.8819095815495253`*^9}, {
  3.881919691301527*^9, 3.8819196924598618`*^9}, {3.901538595974272*^9, 
  3.901538602259982*^9}, {3.9015404374097*^9, 3.9015404376716146`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5872f270-6dc9-485a-b1c3-01c53148a9c8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"4", 
      FractionBox[
       RowBox[{"12", " ", "\[Chi]"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[Chi]", "2"]}]}]]},
     {"0", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[Chi]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[Chi]", "2"]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.881909563914062*^9, 3.88190960049544*^9, 3.8819186141514597`*^9, 
   3.881918775761352*^9, 3.8819195715334578`*^9, 3.881919721045636*^9, 
   3.8819197796211853`*^9, {3.881919832521337*^9, 3.881919848480551*^9}, 
   3.881919956444447*^9, {3.8819203051786337`*^9, 3.88192035699971*^9}, 
   3.8819216856145353`*^9, 3.881923366647344*^9, 3.881923428583754*^9, 
   3.8819238490601673`*^9, 3.881924007845559*^9, 3.881925766323627*^9, 
   3.881925980449244*^9, 3.881926060678774*^9, 3.881926176089562*^9, 
   3.881926275265788*^9, 3.881926497576893*^9, 3.881926932012805*^9, 
   3.881949368474167*^9, {3.88194988880162*^9, 3.881949906142725*^9}, 
   3.881990579334899*^9, 3.881990716843533*^9, 3.8824197601686287`*^9, 
   3.8824215859936953`*^9, 3.882421711513359*^9, 3.8824217829540033`*^9, 
   3.882421817669675*^9, {3.901538598929636*^9, 3.901538602591461*^9}, 
   3.9015394499592037`*^9, {3.901540317822822*^9, 3.901540343217677*^9}, 
   3.901540531719555*^9, 3.901798370723325*^9, 3.90179937153259*^9},
 CellLabel->
  "Out[7]//MatrixForm=",ExpressionUUID->"8d40ab8d-5f0e-4d75-af83-\
2b9832198e6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", 
   RowBox[{"\"\<r\>\"", ",", "k", ",", "d", ",", "\[Chi]", ",", 
    SubscriptBox["\[Sigma]", "x"]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8819095249653587`*^9, 3.881909528618874*^9}, {
  3.881909590279634*^9, 3.8819095921092978`*^9}, {3.881918604014927*^9, 
  3.881918604268342*^9}, {3.881919562784523*^9, 3.881919562880287*^9}, {
  3.881919694565216*^9, 3.881919694799797*^9}, {3.881920277445593*^9, 
  3.8819202775892572`*^9}, {3.901538620509886*^9, 3.901538625846874*^9}, {
  3.9015403475235643`*^9, 3.901540352146387*^9}, {3.901540421583967*^9, 
  3.901540439576882*^9}, {3.90154051507312*^9, 3.901540517708366*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"4c7515a1-87bf-4004-b7aa-f6d26291a811"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox["4", 
        RowBox[{"1", "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}]]},
      {
       FractionBox[
        RowBox[{"4", " ", "\[Chi]"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Chi]", "2"]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.881220867249748*^9, 3.8812293925485163`*^9, {3.881909563969328*^9, 
   3.8819096005703583`*^9}, 3.881918614203086*^9, 3.881918775815353*^9, 
   3.881919571588312*^9, 3.881919721131887*^9, 3.881919779677322*^9, {
   3.881919832692415*^9, 3.881919848546034*^9}, 3.881919956494676*^9, {
   3.881920305233118*^9, 3.881920357056354*^9}, 3.881921685678931*^9, 
   3.8819233666772738`*^9, 3.881923428639105*^9, 3.881923849209003*^9, 
   3.88192400787527*^9, 3.881925766417136*^9, 3.881925980565032*^9, 
   3.881926060769053*^9, 3.881926176163185*^9, 3.8819262753320513`*^9, 
   3.8819264976531982`*^9, 3.881926932074152*^9, 3.881949368516561*^9, {
   3.881949888839595*^9, 3.881949906188603*^9}, 3.881990579384317*^9, 
   3.881990716906101*^9, 3.882419760222714*^9, 3.882421586185083*^9, 
   3.882421711592094*^9, 3.882421783027245*^9, 3.8824218177331944`*^9, 
   3.901538626137268*^9, 3.901540352626997*^9, 3.901540531729732*^9, 
   3.9017983707701*^9, 3.901799371544463*^9},
 CellLabel->
  "Out[8]//MatrixForm=",ExpressionUUID->"395f4b65-58d1-4139-a8e0-\
f884737aa7f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"\"\<l\>\"", ",", "k", ",", "d", ",", "\[Chi]", ",", 
     SubscriptBox["\[Sigma]", "x"]}], "]"}], ".", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"k", ",", "d", ",", "\[Chi]"}], "]"}], ",", "r"}], "]"}], ".", 
   RowBox[{"T", "[", 
    RowBox[{"\"\<r\>\"", ",", "k", ",", "d", ",", "\[Chi]", ",", 
     SubscriptBox["\[Sigma]", "x"]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.881909540373419*^9, 3.881909588170082*^9}, {
  3.881909742275751*^9, 3.8819097486940937`*^9}, {3.881918642705594*^9, 
  3.881918649980047*^9}, {3.881919564767565*^9, 3.881919568270105*^9}, {
  3.881919749870976*^9, 3.8819197547770348`*^9}, {3.8819198394678698`*^9, 
  3.8819198457349997`*^9}, {3.8819202797261*^9, 3.881920281926317*^9}, {
  3.901540374665395*^9, 3.9015403926885138`*^9}, {3.901540423150199*^9, 
  3.901540446309874*^9}, {3.901540540980076*^9, 3.9015405500517073`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9bb986d9-556e-4705-a64d-226e3c59c323"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Chi]", "2"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Chi]", "2"]}], ")"}], 
   RowBox[{"1", "+", "r"}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], "+", 
     SuperscriptBox["\[Chi]", "2"]}], ")"}], 
   RowBox[{
    RowBox[{"-", "2"}], "-", "r"}]]}]], "Output",
 CellChangeTimes->{
  3.881909564031019*^9, 3.881909600629038*^9, 3.8819097548861*^9, 
   3.8819186142536497`*^9, 3.881918775931452*^9, 3.8819195716481*^9, 
   3.88191972121494*^9, 3.881919779719246*^9, {3.881919832790711*^9, 
   3.881919851360922*^9}, 3.881919956558152*^9, {3.8819203052908573`*^9, 
   3.881920357114406*^9}, 3.88192168575439*^9, 3.881923366741127*^9, 
   3.881923428659436*^9, 3.881923849259075*^9, 3.881924007971476*^9, 
   3.881925766538047*^9, 3.881925980701198*^9, 3.8819260609053373`*^9, 
   3.8819261762571163`*^9, 3.881926275399048*^9, 3.881926497726851*^9, 
   3.8819269321452827`*^9, 3.881949368587734*^9, {3.8819498888827467`*^9, 
   3.881949906194625*^9}, 3.881990579442204*^9, 3.8819907169785748`*^9, 
   3.8824197602940903`*^9, 3.882421589834331*^9, 3.882421712023992*^9, 
   3.882421783578236*^9, 3.882421817760838*^9, 3.901540355348422*^9, 
   3.9015403952334633`*^9, {3.901540531802146*^9, 3.9015405511795177`*^9}, 
   3.901798370904603*^9, 3.9017993716627703`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"af45a679-2d4d-4a58-b9d4-25d37f35cbb3"]
}, Open  ]]
},
WindowSize->{1440, 785},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->{},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"efcfb873-225f-4b89-beef-ca76e1d6b51b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 243, 5, 30, "Input",ExpressionUUID->"694fd6f5-b194-4272-8845-48634371335b"],
Cell[804, 27, 463, 7, 30, "Input",ExpressionUUID->"d9329c70-b302-47a9-aaa1-8b0a48969354"],
Cell[1270, 36, 211, 4, 30, "Input",ExpressionUUID->"6ba1c8c3-3fc4-4804-9eff-855d4bf927e9"],
Cell[1484, 42, 211, 4, 30, "Input",ExpressionUUID->"05f0ed0b-6a4d-4b70-91e6-304625873ee5"],
Cell[1698, 48, 394, 11, 30, "Input",ExpressionUUID->"15f8e82d-ceb0-4c5c-8059-cfe00bf8c7d3"],
Cell[CellGroupData[{
Cell[2117, 63, 965, 15, 30, "Input",ExpressionUUID->"a94be308-bd99-4e98-af1b-c061130b0a93"],
Cell[3085, 80, 2068, 47, 80, "Output",ExpressionUUID->"6ba95f69-b0cb-4f71-9068-34aa9cfffd01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5190, 132, 714, 12, 30, "Input",ExpressionUUID->"5872f270-6dc9-485a-b1c3-01c53148a9c8"],
Cell[5907, 146, 2070, 49, 92, "Output",ExpressionUUID->"8d40ab8d-5f0e-4d75-af83-2b9832198e6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8014, 200, 768, 12, 30, "Input",ExpressionUUID->"4c7515a1-87bf-4004-b7aa-f6d26291a811"],
Cell[8785, 214, 1914, 45, 82, "Output",ExpressionUUID->"395f4b65-58d1-4139-a8e0-f884737aa7f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10736, 264, 1079, 20, 30, "Input",ExpressionUUID->"9bb986d9-556e-4705-a64d-226e3c59c323"],
Cell[11818, 286, 1513, 32, 49, "Output",ExpressionUUID->"af45a679-2d4d-4a58-b9d4-25d37f35cbb3"]
}, Open  ]]
}
]
*)

